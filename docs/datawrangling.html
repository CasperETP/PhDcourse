<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data wrangling and tidy data | The data-wrangling and omics course for R novices</title>
  <meta name="description" content="A tutorial on how to do data-wrangling and analysing omics data" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data wrangling and tidy data | The data-wrangling and omics course for R novices" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A tutorial on how to do data-wrangling and analysing omics data" />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data wrangling and tidy data | The data-wrangling and omics course for R novices" />
  
  <meta name="twitter:description" content="A tutorial on how to do data-wrangling and analysing omics data" />
  

<meta name="author" content="Casper-Emil Tingskov Pedersen and Jonathan Thorsen" />


<meta name="date" content="2023-10-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dataintro.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to this course</a></li>
<li class="chapter" data-level="2" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>2</b> Course overview</a>
<ul>
<li class="chapter" data-level="2.1" data-path="overview.html"><a href="overview.html#what-can-you-expect"><i class="fa fa-check"></i><b>2.1</b> What can you expect</a></li>
<li class="chapter" data-level="2.2" data-path="overview.html"><a href="overview.html#general-learning-outcomes"><i class="fa fa-check"></i><b>2.2</b> General learning outcomes</a></li>
<li class="chapter" data-level="2.3" data-path="overview.html"><a href="overview.html#our-workflow-plus-the-tidy-data-workflow"><i class="fa fa-check"></i><b>2.3</b> Our workflow plus the Tidy data workflow</a></li>
<li class="chapter" data-level="2.4" data-path="overview.html"><a href="overview.html#working-with-data-that-is-not-your-own"><i class="fa fa-check"></i><b>2.4</b> Working with data that is not your own</a></li>
<li class="chapter" data-level="2.5" data-path="overview.html"><a href="overview.html#goals-of-this-course"><i class="fa fa-check"></i><b>2.5</b> Goals of this course</a></li>
<li class="chapter" data-level="2.6" data-path="overview.html"><a href="overview.html#prerequisites"><i class="fa fa-check"></i><b>2.6</b> Prerequisites</a></li>
<li class="chapter" data-level="2.7" data-path="overview.html"><a href="overview.html#credit"><i class="fa fa-check"></i><b>2.7</b> Credit</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dataintro.html"><a href="dataintro.html"><i class="fa fa-check"></i><b>3</b> Super quick intro to coding and data in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dataintro.html"><a href="dataintro.html#codingprogramming-in-r"><i class="fa fa-check"></i><b>3.1</b> Coding/programming in R</a></li>
<li class="chapter" data-level="3.2" data-path="dataintro.html"><a href="dataintro.html#basic-terminology-in-r"><i class="fa fa-check"></i><b>3.2</b> Basic terminology in R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="dataintro.html"><a href="dataintro.html#exercise1"><i class="fa fa-check"></i><b>3.2.1</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dataintro.html"><a href="dataintro.html#error-messages"><i class="fa fa-check"></i><b>3.3</b> Error messages</a></li>
<li class="chapter" data-level="3.4" data-path="dataintro.html"><a href="dataintro.html#coding-tips-and-tricks"><i class="fa fa-check"></i><b>3.4</b> Coding tips and tricks</a></li>
<li class="chapter" data-level="3.5" data-path="dataintro.html"><a href="dataintro.html#installpackages"><i class="fa fa-check"></i><b>3.5</b> Install and load package</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="datawrangling.html"><a href="datawrangling.html"><i class="fa fa-check"></i><b>4</b> Data wrangling and tidy data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="datawrangling.html"><a href="datawrangling.html#packages-required"><i class="fa fa-check"></i><b>4.1</b> Packages required</a></li>
<li class="chapter" data-level="4.2" data-path="datawrangling.html"><a href="datawrangling.html#using-functions-of-the-penguins-dataset"><i class="fa fa-check"></i><b>4.2</b> Using functions of the penguins dataset</a></li>
<li class="chapter" data-level="4.3" data-path="datawrangling.html"><a href="datawrangling.html#load-in-a-dataset-from-the-internet"><i class="fa fa-check"></i><b>4.3</b> Load in a dataset from the internet</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="datawrangling.html"><a href="datawrangling.html#comma-separated-csv"><i class="fa fa-check"></i><b>4.3.1</b> comma separated (csv)</a></li>
<li class="chapter" data-level="4.3.2" data-path="datawrangling.html"><a href="datawrangling.html#table-can-be-anything-that-has-table-structure"><i class="fa fa-check"></i><b>4.3.2</b> table (can be anything that has table structure)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="datawrangling.html"><a href="datawrangling.html#data-types-in-r"><i class="fa fa-check"></i><b>4.4</b> Data types in R</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The data-wrangling and omics course for R novices</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="datawrangling" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Data wrangling and tidy data<a href="datawrangling.html#datawrangling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="https://andreashandel.github.io/MADAcourse/media/cartoonscrubdata.jpg" /></p>
<div id="packages-required" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Packages required<a href="datawrangling.html#packages-required" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following packages are required. If you need to go back and check how installing a package is done see the section 3.5(#installpackages).</p>
<p>library(dplyr).<br />
library(ggplot2).<br />
library(readr).<br />
library(tidyr).<br />
library(broom).<br />
library(palmerpenguins).</p>
<p>This chapter will introduce you to data wrangling with an emphasis on the <code>dplyr</code> package along with other helpful functions. You will see how powerful wrangling can be and how it can be like a magic wand to transform data into your specific needs. The key functions include but are not limited to:</p>
<ol style="list-style-type: decimal">
<li>The overarching function which makes us able to combine functions and subsetting is <strong>the pipe</strong>. And what is a pipe? Pipes are a neat way to tie together several dataframes/functions into a chain of actions. It makes coding easier to understand and is therefore a better style of coding. It looks like this <code>%&gt;%</code>. For instance taking the mean of the first two rows of the <code>my_df</code> dataframe can be done like so:
<code>my_df[1:2,"Grades"] %&gt;% mean</code>. Learning to use the pipe to your advantage is learning to code. Luckily it all comes naturally when working with the following functions:</li>
</ol>
<p>1.<code>left_join()</code> merge two data frames together using a key column. This function (along with its cousin functions <code>right_join()</code> and <code>join()</code> etc.) is the bread and butter of working with many data types that needs to be merged and analysed.</p>
<ol style="list-style-type: decimal">
<li><p><code>mutate()</code> construct/reconstruct a column using a newly defined column name. This function is useful to generate a new columns that modify existing ones often using a conditional to do so.</p></li>
<li><p><code>count()</code> counts the n of each unique value in a column. Usefull to combine with mutate to see the counts of the newly constructed column.</p></li>
<li><p><code>arrange()</code> reorder the rows of a dataframe. For example, sort the rows of a dataset in descending order of the column height.</p></li>
<li><p><code>filter()</code> the rows of a dataframe based on a filter, e.g. thresholds. It is similar to the example shown in the introduction, where we used old school filtering on my_df dataframe <code>my_df[my_df$names %in% c("Karl","Villy"),]</code>. Using the filter function and pipes you can do it like this: <code>my_df %&gt;% filter(names %in% c("Karl","Villy"))</code>.</p></li>
<li><p><code>summarise()</code> a dataframe using one or more of its columns/variables with a summary statistic. Such examples could be the median or the mean and an example look like this: <code>my_df %&gt;% summarise(mean = mean(Grades))</code>. This function can be very powerful when combined with the <code>group_by</code> function.</p></li>
<li><p><code>group_by()</code> is a dplyr way of grouping rows, it is a way to assign different rows to a group and do statistical reporting on every specific group in the data set. An example require us to add a third column to <code>my_df</code> like this:
<code>my_df &lt;- my_df %&gt;% mutate(gender = c("boy","boy","boy","boy","girl"))</code>. Now using this new <code>my_df</code> we can <code>group_by</code> on the gender column and calculate the median on this group:</p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="datawrangling.html#cb1-1" aria-hidden="true" tabindex="-1"></a>my_df <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="datawrangling.html#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="datawrangling.html#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">median</span>(Grades)) </span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   gender `median(Grades)`
##   &lt;chr&gt;             &lt;dbl&gt;
## 1 boy                  35
## 2 girl                 60</code></pre>
</div>
<div id="using-functions-of-the-penguins-dataset" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Using functions of the penguins dataset<a href="datawrangling.html#using-functions-of-the-penguins-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="load-in-a-dataset-from-the-internet" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Load in a dataset from the internet<a href="datawrangling.html#load-in-a-dataset-from-the-internet" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Open this link in a new tab by copy-pasting and save it to your computer using right-click (<a href="https://raw.githubusercontent.com/zief0002/miniature-garbanzo/main/data/gapminder.csv" class="uri">https://raw.githubusercontent.com/zief0002/miniature-garbanzo/main/data/gapminder.csv</a>).
Save it as “gapminder2017”.</p>
<div id="comma-separated-csv" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> comma separated (csv)<a href="datawrangling.html#comma-separated-csv" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>try read it in using read csv, the file ending is automatically put on there, so even though you did not name it gapminder2017.csv, that is the name it will get.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="datawrangling.html#cb3-1" aria-hidden="true" tabindex="-1"></a>gapminder2017 <span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;~/241023_phdcourse/data/gapminder2017.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="table-can-be-anything-that-has-table-structure" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> table (can be anything that has table structure)<a href="datawrangling.html#table-can-be-anything-that-has-table-structure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>read.table</p>
<p>library(gapminder)</p>
<p>now load this dataset which has all the years, install it if you havent already</p>
</div>
</div>
<div id="data-types-in-r" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Data types in R<a href="datawrangling.html#data-types-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Even though data types is a dull subject and therefore very hard to teach properly. It does serve an important purpose. Namely that you can figure out where error messages come from and which tools to use on which data</p>
<p>Now lets show an example of this:
<code>my_df[seq(1,3),]</code></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dataintro.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jules32/bookdown-tutorial/edit/master/Data_wrangling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["data course.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
